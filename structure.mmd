flowchart TD
    A[üë§ Visiteur arrive sur le site] --> B{Poss√®de un compte?}
    
    B -->|Non| C[üìù Inscription]
    B -->|Oui| D[üîê Connexion]
    
    C --> C1[Saisit: nom, email, mot de passe]
    C1 --> C2[Validation des donn√©es]
    C2 -->|‚úÖ Valide| C3[Compte cr√©√© avec succ√®s]
    C2 -->|‚ùå Erreur| C4[Message d'erreur]
    C4 --> C1
    C3 --> D
    
    D --> D1[Saisit: email + mot de passe]
    D1 --> D2[V√©rification identifiants]
    D2 -->|‚úÖ Correct| D3[Token JWT g√©n√©r√©]
    D2 -->|‚ùå Incorrect| D4[Erreur de connexion]
    D4 --> D1
    
    D3 --> E[üè† Dashboard Principal]
    
    E --> E1[üìä Affiche statistiques:<br/>- Pages connect√©es: 0<br/>- R√©ponses actives: 0<br/>- Messages trait√©s: 0<br/>- IA configur√©e: 0]
    
    E1 --> F{Que voulez-vous faire?}
    
    F -->|Connecter une page| G[üìò Section Pages Facebook]
    F -->|Configurer r√©ponses| H[üí¨ Section R√©ponses Pr√©d√©finies]
    F -->|Setup IA| I[ü§ñ Section Configuration IA]
    F -->|Voir historique| J[üìú Section Historique]
    
    %% GESTION DES PAGES FACEBOOK
    G --> G1[‚ûï Ajouter une Page]
    G1 --> G2[Saisit:<br/>- ID de la page<br/>- Nom de la page<br/>- Token d'acc√®s Facebook]
    G2 --> G3[Validation du token avec Facebook API]
    G3 -->|‚úÖ Token valide| G4[Page ajout√©e et sauv√©e en DB]
    G3 -->|‚ùå Token invalide| G5[Erreur: Token ou permissions incorrects]
    G5 --> G2
    G4 --> G6[Page visible dans la liste]
    G6 --> G7{Configurer le webhook?}
    G7 -->|Oui| G8[Setup automatique webhook Facebook]
    G7 -->|Plus tard| F
    G8 --> G9[‚úÖ Page pr√™te √† recevoir des messages]
    G9 --> F
    
    %% R√âPONSES PR√âD√âFINIES
    H --> H1[S√©lectionne une page connect√©e]
    H1 --> H2[‚ûï Ajouter une R√©ponse]
    H2 --> H3[Configure:<br/>- Mot-cl√© d√©clencheur<br/>- R√©ponse √† envoyer<br/>- Priorit√© 1-3<br/>- Type de correspondance]
    H3 --> H4[Sauvegarde en base de donn√©es]
    H4 --> H5[‚úÖ R√©ponse pr√©d√©finie active]
    H5 --> H6{Ajouter d'autres r√©ponses?}
    H6 -->|Oui| H2
    H6 -->|Non| F
    
    %% CONFIGURATION IA
    I --> I1[Choisit une page]
    I1 --> I2[Configure l'IA:<br/>- Provider OpenAI/Mistral/Claude<br/>- Mod√®le GPT-4/Claude-3/etc.<br/>- Cl√© API personnelle<br/>- Temp√©rature 0.1-1.0<br/>- Ton: amical/professionnel/etc.<br/>- Instructions personnalis√©es]
    I2 --> I3[Test de la cl√© API]
    I3 -->|‚úÖ Cl√© valide| I4[Configuration IA sauv√©e]
    I3 -->|‚ùå Cl√© invalide| I5[Erreur: V√©rifiez votre cl√© API]
    I5 --> I2
    I4 --> I6[‚úÖ IA active comme fallback]
    I6 --> F
    
    %% HISTORIQUE
    J --> J1[S√©lectionne une page ou toutes]
    J1 --> J2[üìã Affiche historique des messages:<br/>- Date/heure<br/>- Exp√©diteur<br/>- Message re√ßu<br/>- R√©ponse envoy√©e<br/>- Type: pr√©d√©finie/IA/aucune]
    J2 --> F
    
    %% TRAITEMENT AUTOMATIQUE DES MESSAGES
    K[üì± Message re√ßu sur page Facebook] --> K1[Webhook d√©clench√©]
    K1 --> K2[üîç Recherche r√©ponse pr√©d√©finie]
    K2 -->|‚úÖ Mot-cl√© trouv√©| K3[Envoie r√©ponse pr√©d√©finie]
    K2 -->|‚ùå Aucun match| K4{IA configur√©e?}
    
    K4 -->|‚úÖ Oui| K5[ü§ñ G√©n√®re r√©ponse IA]
    K4 -->|‚ùå Non| K6[Aucune r√©ponse envoy√©e]
    
    K5 --> K7[Envoie r√©ponse IA]
    
    K3 --> K8[üìù Sauvegarde dans historique]
    K7 --> K8
    K6 --> K8
    
    K8 --> K9[üîÑ Met √† jour statistiques dashboard]
    K9 --> L[‚úÖ Traitement termin√©]
    
    %% MONITORING
    M[‚ö° Temps r√©el] --> M1[Dashboard se met √† jour automatiquement]
    M1 --> M2[üìä Nouvelles statistiques:<br/>- Pages: 2<br/>- R√©ponses: 15<br/>- Messages: 47<br/>- IA: 1]
    
    %% GESTION DU COMPTE
    N[üë§ Menu utilisateur] --> N1{Actions compte}
    N1 -->|Param√®tres| N2[‚öôÔ∏è Modifier profil]
    N1 -->|D√©connexion| N3[üö™ Logout + suppression token]
    N3 --> A
    
    %% STYLES
    classDef processBox fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef successBox fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
    classDef errorBox fill:#ffebee,stroke:#c62828,stroke-width:2px
    classDef decisionBox fill:#fff3e0,stroke:#ef6c00,stroke-width:2px
    classDef aiBox fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef fbBox fill:#e3f2fd,stroke:#1565c0,stroke-width:2px
    
    class C,D,G,H,I,J processBox
    class C3,G4,G9,H5,I4,I6,L successBox
    class C4,D4,G5,I5 errorBox
    class B,F,G7,H6,K4,N1 decisionBox
    class I,I1,I2,I4,K5,K7 aiBox
    class G,G1,G2,G4,K,K1 fbBox
